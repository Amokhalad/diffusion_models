<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Fun With Diffusion Models</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="139c01c0-e9d6-8007-87ad-c2737e103c38" class="page sans"><header><h1 class="page-title">Fun With Diffusion Models</h1><p class="page-description"></p></header><div class="page-body"><h1 id="139c01c0-e9d6-8043-9833-cdf59c3460bc" class=""><strong>Part A: The Power of Diffusion Models</strong></h1><h2 id="139c01c0-e9d6-809d-bc2d-d3bb29b23179" class=""><strong>Part 0: Setup</strong></h2><p id="139c01c0-e9d6-8057-90d9-fdd4914b37d1" class="">We are going to use the <a href="https://www.google.com/url?q=https%3A%2F%2Fhuggingface.co%2Fdocs%2Fdiffusers%2Fapi%2Fpipelines%2Fdeepfloyd_if">DeepFloyd IF</a> diffusion model. DeepFloyd is a two stage model trained by Stability AI. The first stage produces images of size 64×64 and the second stage takes the outputs of the first stage and generates images of size 256×256. </p><p id="139c01c0-e9d6-8079-b5ce-f817d638081e" class="">
</p><p id="139c01c0-e9d6-809c-9b3d-fec74d3e1fbd" class="">To demonstrate using this model, we used <strong>SEED 180 </strong>and generated the following images with the textprompt shown as the caption:</p><div id="139c01c0-e9d6-8007-8246-cf3a3f55daa0" class="column-list"><div id="139c01c0-e9d6-809f-8330-eed8180ac2f6" style="width:33.333333333333336%" class="column"><figure id="139c01c0-e9d6-8002-8769-cdf6401c4b81" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_man_wear.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_man_wear.png"/></a><figcaption>Prompt: a man wearing a hat</figcaption></figure></div><div id="139c01c0-e9d6-8076-85f7-d4105cdcfc3e" style="width:33.333333333333336%" class="column"><figure id="139c01c0-e9d6-802e-8084-ea344ebdbbe6" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_rocket_s.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_rocket_s.png"/></a><figcaption>Prompt: a rocket ship</figcaption></figure></div><div id="139c01c0-e9d6-8024-adbb-daadfea58c1d" style="width:33.33333333333333%" class="column"><figure id="139c01c0-e9d6-8086-8b61-f2e1c315869f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_an_oil_pai.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_an_oil_pai.png"/></a><figcaption>Prompt: an oil painting of a snowy mountain village</figcaption></figure></div></div><p id="139c01c0-e9d6-802c-9c10-c238145f39e8" class="">As we can see above, the generated images closely align with the provided prompts. The first image generated is a white bearded man with, in a suit, and of course wearing a hat. It looks natural and even includes wrinkles on his forehead. However, there&#x27;s a slight imperfection as the eyes appear cross-eyed, indicating a limitation in the model&#x27;s rendering of facial features, or does it?</p><p id="139c01c0-e9d6-80c4-bf2f-cfb3f14ffb04" class="">For the second image, the model chose to go with a blend of cartoonish elements with realistic surroundings. The rocket ship itself is a cartoon figure, however, the clouds and sky appear to be more realistic.</p><p id="139c01c0-e9d6-8044-a16e-fa986b48bcda" class="">For the third image, well it looks really pleasing to the eye.</p><h3 id="139c01c0-e9d6-80fd-80a9-c3827d3ee702" class="">Experimenting with <code>num_inference_steps</code></h3><p id="139c01c0-e9d6-8037-baaa-d1343c00188b" class="">The <code>num_inference_steps</code> parameter (1-1000) determines denoising steps: lower values speed up generation but may reduce quality. Here, the original images above used 20 steps; below, we try 10 steps with the same prompts:</p><div id="139c01c0-e9d6-8064-8afe-e9591bf4b098" class="column-list"><div id="139c01c0-e9d6-8003-906e-f4d86b8b70ca" style="width:33.333333333333336%" class="column"><figure id="139c01c0-e9d6-809f-a169-f058aba905c6" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_man_wear10.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_man_wear10.png"/></a></figure></div><div id="139c01c0-e9d6-8093-9b76-f895c433b62b" style="width:33.333333333333336%" class="column"><figure id="139c01c0-e9d6-80b6-adc6-fc931b6fdcbd" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_rocket_s10.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_a_rocket_s10.png"/></a></figure></div><div id="139c01c0-e9d6-807e-b944-ed1bf4a4e456" style="width:33.33333333333333%" class="column"><figure id="139c01c0-e9d6-80d8-8319-e1cc6bf82f2d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_an_oil_pai10.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/stage_2_an_oil_pai10.png"/></a></figure></div></div><p id="139c01c0-e9d6-80fa-90f8-f26d61d22a88" class="">Interesting. The man in the hat no longer has color, and appear to be a completely different man, with no beard. The rocket ship looks a bit deformed, with and a different architecture, and the snow mountain village still looks nice, but not as cartoonish and bloomy/vivid as the previous.</p><p id="139c01c0-e9d6-8069-99d9-d4e13082c641" class="">
</p><h3 id="139c01c0-e9d6-80e9-8aa3-fe9b2e41e8f4" class="">1.1 Forward Pass</h3><p id="147c01c0-e9d6-8057-b63f-e277fc18c180" class="">A key part of diffusion is the forward process, which takes a clean image and adds noise to it. The forward process is defined by:</p><figure id="13ac01c0-e9d6-8075-8e0d-d6d1657e6b31" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><mi>ϵ</mi><mspace width="1em"/><mtext>where </mtext><mi>ϵ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">x_t = \sqrt{\bar\alpha_t} x_0 + \sqrt{1 - \bar\alpha_t} \epsilon \quad \text{where}~ \epsilon \sim N(0, 1) \tag{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8428em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1972em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1589em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">where</span></span><span class="mspace nobreak"> </span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1.1311em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></div></figure><p id="147c01c0-e9d6-8091-9f2d-ff44edebfd9f" class="">in code, it will be as follows:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="147c01c0-e9d6-8006-a38d-ec449822a2c8" class="code"><code class="language-Python">def forward(im, t):
    eps = torch.randn_like(im)
    alpha_t = alphas_cumprod[t]
    im_t = (torch.sqrt(alpha_t) * im) + (torch.sqrt(1 - alpha_t) * eps)
    return im_t</code></pre><p id="147c01c0-e9d6-803a-8b05-fb6508cc115f" class="">Lets run the forward process at noise levels 250, 500, and 750:</p><div id="139c01c0-e9d6-80bc-bb10-f570b3a876d8" class="column-list"><div id="139c01c0-e9d6-803d-81c2-d93de15b8dd4" style="width:25%" class="column"><figure id="139c01c0-e9d6-8070-b99f-df7e83470aea" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile0.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile0.png"/></a><figcaption>t = 0</figcaption></figure></div><div id="139c01c0-e9d6-80b0-8a6f-fa74b6a16f4d" style="width:25%" class="column"><figure id="139c01c0-e9d6-8092-8907-df383e5bebaf" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile250.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile250.png"/></a><figcaption>t = 250</figcaption></figure></div><div id="139c01c0-e9d6-8050-9998-ccedab1ccb57" style="width:25%" class="column"><figure id="139c01c0-e9d6-80d4-95a9-fe95806e3bc5" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile500.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile500.png"/></a><figcaption>t = 500</figcaption></figure></div><div id="139c01c0-e9d6-80db-93cf-c97656d4b511" style="width:25%" class="column"><figure id="139c01c0-e9d6-803f-9b2e-e5d8845b16ba" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile750.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile750.png"/></a><figcaption>t = 750</figcaption></figure></div></div><h3 id="139c01c0-e9d6-8083-bed7-ec51a7fe4fe6" class="">1.2 Classical Denoising (Gaussian blur)</h3><p id="147c01c0-e9d6-80b5-89e4-fb4652e98e6c" class="">Let&#x27;s try to denoise these images using classical methods. Again, take noisy images for timesteps [250, 500, 750], but use <strong>Gaussian blur filtering</strong> to try to remove the noise. Getting good results should be quite difficult, if not impossible.</p><div id="139c01c0-e9d6-8036-b799-ff73301bf38f" class="column-list"><div id="139c01c0-e9d6-801a-a707-f18abc65c6d5" style="width:33.33333333333333%" class="column"><figure id="139c01c0-e9d6-807a-88c4-c6c256d53ed5" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd_campanile_250.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd_campanile_250.png"/></a><figcaption>Gaussian Blur Denoising at t=250</figcaption></figure></div><div id="139c01c0-e9d6-806c-bf64-ee3bca25d101" style="width:33.33333333333333%" class="column"><figure id="139c01c0-e9d6-800c-818f-d4d0cbe3c5bb" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd_campanile_500.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd_campanile_500.png"/></a><figcaption>Gaussian Blur Denoising at t=500</figcaption></figure></div><div id="139c01c0-e9d6-803a-9d7f-ed14f9f9c901" style="width:33.33333333333333%" class="column"><figure id="139c01c0-e9d6-808a-a058-d7a63eed37fa" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd_campanile_750.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd_campanile_750.png"/></a><figcaption>Gaussian Blur Denoising at t=750</figcaption></figure></div></div><h3 id="139c01c0-e9d6-80da-aa31-ffd437730ec6" class="">1.3 One shot denoising</h3><p id="13ac01c0-e9d6-8015-820f-d29d0a3f106a" class="">Using the equation from 1.1, we can solve for <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, giving us:</p><figure id="13ac01c0-e9d6-80fb-9c08-f502760a414b" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><mi>ϵ</mi></mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt></mfrac><mspace width="1em"/><mtext>where </mtext><mi>ϵ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">x_0 = \frac{x_t - \sqrt{1 - \bar\alpha_t}\epsilon}{\sqrt{\bar\alpha_t}} \quad \text{where}~ \epsilon \sim N(0, 1) \tag{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4413em;vertical-align:-0.9321em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5092em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span><span class="mord mathnormal">ϵ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9321em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">where</span></span><span class="mspace nobreak"> </span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:2.4413em;vertical-align:-0.9321em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></div></figure><p id="13ac01c0-e9d6-804f-97b2-d2e936e657aa" class="">Using the deoniser, we estimate what noise, epsilon is. With this process, we get these results</p><div id="13ac01c0-e9d6-80c3-9851-ef4f09863b1f" class="column-list"><div id="13ac01c0-e9d6-80a4-8e02-c5a558260fe5" style="width:33.333333333333336%" class="column"><figure id="13ac01c0-e9d6-8008-a27d-dd13de08147b" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/1sd_camp_250.png.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/1sd_camp_250.png.png"/></a><figcaption>One-Step Denoised Campanile at t=250</figcaption></figure></div><div id="13ac01c0-e9d6-801e-893f-ccc98220528f" style="width:33.33333333333333%" class="column"><figure id="13ac01c0-e9d6-8033-8929-f6e32c58a0ae" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/1sd_camp_500.png.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/1sd_camp_500.png.png"/></a><figcaption>One-Step Denoised Campanile at t=500</figcaption></figure></div><div id="13ac01c0-e9d6-8047-9108-e9eb24d7de5c" style="width:33.333333333333336%" class="column"><figure id="13ac01c0-e9d6-8022-9b64-d6069b885e65" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/1sd_camp_750.png.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/1sd_camp_750.png.png"/></a><figcaption>One-Step Denoised Campanile at t=750</figcaption></figure></div></div><h3 id="13ac01c0-e9d6-809a-9edd-dacc4beb14dc" class="">1.4 Iterative Denoising</h3><p id="147c01c0-e9d6-8035-b93b-ec92398b0f1e" class="">Diffusion models are designed to denoise iteratively. In this part we will implement this. </p><p id="147c01c0-e9d6-8003-92b1-c86141a56791" class="">In theory, we could start with noise x1000 at timestep T=1000, denoise for one step to get an estimate of x999, and carry on until we get x0. But this would require running the diffusion model 1000 times, which is quite slow (and costs $$$).</p><p id="147c01c0-e9d6-8012-9f63-e343d66a9ada" class="">It turns out, we can actually speed things up by skipping steps. The rationale for why this is possible is due to a connection with differential equations. It&#x27;s a tad complicated, and not within scope for this course, but if you&#x27;re interested you can check out <a href="https://yang-song.net/blog/2021/score/">this excellent article</a>.</p><p id="147c01c0-e9d6-8018-ab25-e437ceec9a39" class="">To skip steps we can create a new list of timesteps that we&#x27;ll call <code>strided_timesteps</code>, which does just this. <code>strided_timesteps</code> will correspond to the noisiest image (and thus the largest t) and <code>strided_timesteps[-1]</code> will correspond to a clean image. One simple way of constructing this list is by introducing a regular stride step (e.g. stride of 30 works well).</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="147c01c0-e9d6-8042-874d-d1872f5e89e1" class="code"><code class="language-Python">strided_timesteps = list(range(990, -1, -30))
stage_1.scheduler.set_timesteps(timesteps=strided_timesteps)    # Need this b/c variance computation</code></pre><p id="147c01c0-e9d6-8057-a2ee-e80e934598ed" class="">On the <code>i</code>th denoising step we are at <code>strided_timesteps[i]</code>, and want to get to <code>strided_timesteps[i+1]</code> (from more noisy to less noisy). To actually do this, we have the following formula:</p><figure id="13fc01c0-e9d6-802a-83b6-cc08a37f49e6" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo>=</mo><mfrac><mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></msqrt><msub><mi>β</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mfrac><mrow><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></mfrac><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>v</mi><mi>σ</mi></msub></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">x_{t&#x27;} = \frac{\sqrt{\bar\alpha_{t&#x27;}}\beta_t}{1 - \bar\alpha_t} x_0 + \frac{\sqrt{\alpha_t}(1 - \bar\alpha_{t&#x27;})}{1 - \bar\alpha_t} x_t + v_\sigma\tag{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3069em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4709em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2907em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4547em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7047em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:2.3069em;vertical-align:-0.836em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></div></figure><p id="13fc01c0-e9d6-805e-b577-f1d98ce7b202" class="">where:<br/>- <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is your image at timestep <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span><br/>- <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mrow><annotation encoding="application/x-tex">x_{t&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is your noisy image at timestep <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">t&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>&lt;</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">t&#x27; &lt; t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.791em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> (less noisy)<br/>- <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is defined by <code>alphas_cumprod</code>, as explained above.<br/>- <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>t</mi></msub><mo>=</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mi mathvariant="normal">/</mi><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mrow><annotation encoding="application/x-tex">\alpha_t = \bar\alpha_t / \bar\alpha_{t&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><br/>- <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\beta_t = 1 - \alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><br/>- <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is our current estimate of the clean image using equation 2 just like in section 1.3</p><p id="147c01c0-e9d6-809f-99ca-eb5caf480dac" class="">
</p><p id="147c01c0-e9d6-807e-8569-e7533d35f9ab" class="">Here is what the noisy image looks like every 5th loop of denoising it. Noitice it becomes gradually less noisy (DENOISING!)</p><div id="13fc01c0-e9d6-80da-ad82-e4cf6d573b82" class="column-list"><div id="13fc01c0-e9d6-80da-b19a-cc7a37b186f9" style="width:33.33333333333333%" class="column"><figure id="13fc01c0-e9d6-806f-9835-d804ff2038bf" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-690.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-690.png"/></a><figcaption>t = 690</figcaption></figure></div><div id="13fc01c0-e9d6-80a9-b134-ea964bc3e9fd" style="width:33.33333333333333%" class="column"><figure id="13fc01c0-e9d6-8007-bf42-e5881ae6019e" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-540.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-540.png"/></a><figcaption>t = 540</figcaption></figure></div><div id="13fc01c0-e9d6-806d-b210-c286c11a22b3" style="width:33.33333333333333%" class="column"><figure id="13fc01c0-e9d6-8094-a7b4-ef62221e1ec4" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-390.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-390.png"/></a><figcaption>t = 390</figcaption></figure></div></div><div id="13fc01c0-e9d6-80dc-b279-c11902bce2c2" class="column-list"><div id="13fc01c0-e9d6-8000-8ab4-cbe8742472b6" style="width:33.333333333333336%" class="column"><figure id="13fc01c0-e9d6-80ac-bd89-e5b04efa5752" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-240.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-240.png"/></a><figcaption>t = 240</figcaption></figure></div><div id="13fc01c0-e9d6-80ae-8e2f-d44ebb2ca1e5" style="width:33.333333333333336%" class="column"><figure id="13fc01c0-e9d6-8030-9e62-ef312428faf3" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-90.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-90.png"/></a><figcaption>t = 90</figcaption></figure></div><div id="13fc01c0-e9d6-807c-b404-dd04c0dc8eab" style="width:33.33333333333333%" class="column"><figure id="13fc01c0-e9d6-80d8-a4d1-d0edbe25d241" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-clean.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-clean.png"/></a><figcaption>t = 0 (clean image)</figcaption></figure></div></div><hr id="13fc01c0-e9d6-8035-ab19-f69c5b41036a"/><p id="13fc01c0-e9d6-8066-8f0b-f4625d9da95c" class="">Lets compare the results thus far:</p><div id="13fc01c0-e9d6-80f6-b62d-ea71e8e11a92" class="column-list"><div id="13fc01c0-e9d6-8099-bb93-e706ac68a182" style="width:33.333333333333336%" class="column"><figure id="13fc01c0-e9d6-805a-9a1e-dbcc48a455d6" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-clean.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/id-campanile-clean.png"/></a><figcaption>Iterative Denoise</figcaption></figure></div><div id="13fc01c0-e9d6-8042-91d9-dd053defffe2" style="width:33.33333333333333%" class="column"><figure id="13fc01c0-e9d6-80f0-974b-f9f05e3b0b2b" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/sd_campanile-690-0.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/sd_campanile-690-0.png"/></a><figcaption>One Shot Denoise</figcaption></figure><p id="13fc01c0-e9d6-8042-aa9a-f5ef96333cc7" class="">
</p></div><div id="13fc01c0-e9d6-8084-bac1-dbc7d13ed543" style="width:33.333333333333336%" class="column"><figure id="13fc01c0-e9d6-807d-97c7-f3a2e0ed5fef" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd-campanile-690-0.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cd-campanile-690-0.png"/></a><figcaption>Classical Denoise</figcaption></figure><p id="13fc01c0-e9d6-8049-a7ec-c9763e517e64" class="">
</p></div></div><h2 id="13fc01c0-e9d6-8026-801f-e139e186d06f" class=""><strong>1.5 Diffusion Model Sampling</strong></h2><p id="147c01c0-e9d6-8076-b981-dce22e72f23e" class="">In part 1.4, we use the diffusion model to denoise an image. Another thing we can do with the <code>iterative_denoise</code> function is to generate images from scratch. We can do this by setting <code>i_start = 0</code> and passing in random noise. This effectively denoises pure noise. Here is  5 results with the prompt embeddings of <code>&quot;a high quality photo&quot;</code>.</p><p id="13fc01c0-e9d6-8020-b182-f39c52fd69cb" class="">
</p><figure id="13fc01c0-e9d6-8081-9395-da9415487618" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Screenshot_2024-11-15_at_3.14.24_PM.jpg"><img style="width:707.9861450195312px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Screenshot_2024-11-15_at_3.14.24_PM.jpg"/></a></figure><h2 id="13fc01c0-e9d6-8034-bf13-fc2ffbcf357b" class="">1.6 Classifier Free Guidance</h2><p id="147c01c0-e9d6-80fd-bfcb-e771ead05158" class="">You may have noticed that the generated images in the prior section are not very good, and some are completely non-sensical. In order to greatly improve image quality (at the expense of image diversity), we can use a technicque called <a href="https://arxiv.org/abs/2207.12598">Classifier-Free Guidance</a>.</p><p id="147c01c0-e9d6-8039-ab00-c8803ed8c06f" class="">In CFG, we compute both a conditional and an unconditional noise estimate. We denote these <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. Then, we let our new noise estimate be:</p><figure id="147c01c0-e9d6-80d1-ba70-e89534ee24e6" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>ϵ</mi><mo>=</mo><msub><mi>ϵ</mi><mi>u</mi></msub><mo>+</mo><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mi>c</mi></msub><mo>−</mo><msub><mi>ϵ</mi><mi>u</mi></msub><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\epsilon = \epsilon_u + \gamma(\epsilon_c - \epsilon_u) \tag{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span></div></figure><p id="147c01c0-e9d6-800a-8eba-ca501cf5e2a3" class="">where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></span><span>﻿</span></span> controls the strength of CFG.</p><p id="147c01c0-e9d6-8094-89e6-d9686f33efba" class="">
</p><p id="147c01c0-e9d6-8098-b05c-e1539918bce5" class="">Here is 5 results with the prompt embeddings of <code>&quot;a high quality photo&quot;</code>.with a CFG scale of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">\gamma = 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span></span><span>﻿</span></span>:</p><figure id="13fc01c0-e9d6-80f9-bc2d-ee85c1149508" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Screenshot_2024-11-15_at_3.34.34_PM.jpg"><img style="width:707.9861450195312px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Screenshot_2024-11-15_at_3.34.34_PM.jpg"/></a></figure><h2 id="13fc01c0-e9d6-80cb-982a-d5659a6d4f96" class="">1.7 <strong>Image-to-image Translation</strong></h2><p id="147c01c0-e9d6-807e-9a20-fd689314a29c" class="">Here, we&#x27;re going to take the original test image, noise it a little, and force it back onto the image manifold without any conditioning. Effectively, we&#x27;re going to get an image that is similar to the test image (with a low-enough noise level). This follows the <a href="https://sde-image-editing.github.io/">SDEdit</a> algorithm.</p><p id="147c01c0-e9d6-8028-bf6f-d9ff2f185079" class="">
</p><p id="147c01c0-e9d6-80e3-b9ea-d2c768b341fa" class="">Lets edit the campanile image, using the given prompt at noise levels [1, 3, 5, 7, 10, 20] with text prompt <code>&quot;a high quality photo&quot;</code>. And these two images below:</p><div id="147c01c0-e9d6-80bd-8eae-d8b2df7a81fa" class="column-list"><div id="147c01c0-e9d6-80e6-aff6-da8958165915" style="width:50%" class="column"><figure id="147c01c0-e9d6-8066-85c2-c4cdbed7e56f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image.png"><img style="width:336px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image.png"/></a></figure></div><div id="147c01c0-e9d6-807f-b942-d58e2d1bca2c" style="width:50%" class="column"><figure id="147c01c0-e9d6-8084-ae52-e0e504c6507f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%201.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%201.png"/></a></figure></div></div><div id="13fc01c0-e9d6-8031-963f-c8e18d57fc77" class="column-list"><div id="13fc01c0-e9d6-800b-b181-da87e743389f" style="width:16.666666666666664%" class="column"><p id="147c01c0-e9d6-801c-99a9-e73f04dab8c2" class="">i_start = 1</p><figure id="13fc01c0-e9d6-80dc-a5bb-fc5b8e3b10a9" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_1.png"><img style="width:132px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_1.png"/></a></figure><figure id="147c01c0-e9d6-80dc-81ae-f9f4723e00e0" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%202.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%202.png"/></a></figure><figure id="147c01c0-e9d6-8001-b375-e6595e97b9b5" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%203.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%203.png"/></a></figure></div><div id="13fc01c0-e9d6-8065-8a3d-dd68db2c087b" style="width:16.666666666666664%" class="column"><p id="147c01c0-e9d6-8090-93e0-ccd93d30aa30" class="">i_start = 3</p><figure id="13fc01c0-e9d6-8033-8126-d1357d3016fe" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_3.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_3.png"/></a></figure><figure id="147c01c0-e9d6-80f3-9653-f3ac81587704" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%204.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%204.png"/></a></figure><figure id="147c01c0-e9d6-8057-b540-c378edbefa01" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%205.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%205.png"/></a></figure></div><div id="13fc01c0-e9d6-8086-a59c-c6c0a3258aa4" style="width:16.666666666666664%" class="column"><p id="147c01c0-e9d6-8091-851e-dd7aad419bd2" class="">i_start = 5</p><figure id="13fc01c0-e9d6-8079-a3e4-f3972c4c2e71" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_5.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_5.png"/></a></figure><figure id="147c01c0-e9d6-8062-a0b3-c9f48ae08e93" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%206.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%206.png"/></a></figure><figure id="147c01c0-e9d6-8054-96fa-eea88ad72ba9" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%207.png"><img style="width:96px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%207.png"/></a></figure></div><div id="13fc01c0-e9d6-8077-987c-f00ac891f9ed" style="width:16.66666666666667%" class="column"><p id="147c01c0-e9d6-80bc-9422-f04d9eed11f7" class="">i_start = 7</p><figure id="13fc01c0-e9d6-80b6-96ab-f1e2efe5868e" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_10.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_10.png"/></a></figure><figure id="147c01c0-e9d6-8098-91c4-e2b6df6c02f4" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%208.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%208.png"/></a></figure><figure id="147c01c0-e9d6-807b-a01b-cb68daec0028" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%209.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%209.png"/></a></figure></div><div id="13fc01c0-e9d6-807d-8dde-e39ed11eb657" style="width:16.666666666666668%" class="column"><p id="147c01c0-e9d6-807a-8891-e4a7b861e81c" class="">i_start = 10</p><figure id="13fc01c0-e9d6-80ce-9bd4-e0808617aa55" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_7.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_7.png"/></a></figure><figure id="147c01c0-e9d6-8007-94e0-f378be5d600e" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2010.png"><img style="width:132px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2010.png"/></a></figure><figure id="147c01c0-e9d6-80b9-bae4-fd20d492c3e1" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2011.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2011.png"/></a></figure></div><div id="13fc01c0-e9d6-801f-8981-f6518f8a6569" style="width:16.666666666666664%" class="column"><p id="147c01c0-e9d6-8096-a4c8-fd85be4296fc" class="">i_start = 20</p><figure id="13fc01c0-e9d6-80e7-bb4f-e989cc18b2c4" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_20.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/im2im-campanile_i_start_20.png"/></a></figure><figure id="147c01c0-e9d6-8008-b05d-c0904fdbd5dc" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2012.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2012.png"/></a></figure><figure id="147c01c0-e9d6-80fd-85fa-e833be9117e4" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2013.png"><img style="width:132px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2013.png"/></a></figure></div></div><h3 id="143c01c0-e9d6-8027-90ce-c6e265a29103" class=""><strong>1.7.1 Editing Hand-Drawn and Web Images</strong></h3><p id="143c01c0-e9d6-80b8-b75a-c105b4c45944" class=""><strong>Web Images:</strong></p><div id="144c01c0-e9d6-80c3-bfe1-d471767c6976" class="column-list"><div id="144c01c0-e9d6-802e-afc5-d88b41a5754c" style="width:50%" class="column"><figure id="144c01c0-e9d6-8059-a79e-fb9787bc7796" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/silver-linings-by-bob-ross-24-x-18-oil-on-canvas-original-painting-952.webp"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/silver-linings-by-bob-ross-24-x-18-oil-on-canvas-original-painting-952.webp"/></a></figure></div><div id="144c01c0-e9d6-8093-b418-c155a9ea9079" style="width:50%" class="column"><figure id="144c01c0-e9d6-8025-9c10-c1ae1254b3fb" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/web_im_(2).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/web_im_(2).png"/></a></figure></div></div><p id="144c01c0-e9d6-809b-9883-db61b282f8a6" class="">
</p><p id="143c01c0-e9d6-80bf-a4f8-ddd200f00e31" class=""><strong>Hand Drawn Images:</strong></p><div id="144c01c0-e9d6-80fd-86b4-f044f8712c16" class="column-list"><div id="144c01c0-e9d6-80aa-8be0-f53e7740fac8" style="width:50%" class="column"><figure id="143c01c0-e9d6-806d-a31e-fefbaff43a2d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/IMG_3540.jpeg"><img style="width:288px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/IMG_3540.jpeg"/></a><figcaption>Strawberry sketch</figcaption></figure></div><div id="144c01c0-e9d6-8059-9883-f34cbeeaf69c" style="width:50%" class="column"><figure id="144c01c0-e9d6-803d-b79a-ea78cd9aaef8" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/berry_translated.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/berry_translated.png"/></a><figcaption>Translated</figcaption></figure></div></div><div id="144c01c0-e9d6-8062-97cf-f14884fc937c" class="column-list"><div id="144c01c0-e9d6-80b9-bf1f-f295be6db648" style="width:50%" class="column"><figure id="143c01c0-e9d6-80ee-af5a-fd259330fbbc" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/IMG_3543.jpeg"><img style="width:288px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/IMG_3543.jpeg"/></a><figcaption>Banana sketch</figcaption></figure></div><div id="144c01c0-e9d6-80fc-87b3-f2051f09d73e" style="width:50%" class="column"><figure id="144c01c0-e9d6-8063-bb47-eec0f5c77c6f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/banana_translated.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/banana_translated.png"/></a><figcaption>Translated</figcaption></figure></div></div><p id="147c01c0-e9d6-8039-92cc-dd7bbb84e704" class="">Lets see what they looked like for noise levels [1, 3, 5, 7, 10, 20]</p><div id="147c01c0-e9d6-8023-85e9-e6d274fafe46" class="column-list"><div id="147c01c0-e9d6-80c4-812d-fa9016d2e0bf" style="width:16.666666666666668%" class="column"><p id="147c01c0-e9d6-8078-a0e0-ea1f6c345a0e" class="">i_start = 1</p><figure id="147c01c0-e9d6-8030-969a-d2dbc1b72561" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2014.png"><img style="width:132px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2014.png"/></a></figure><figure id="147c01c0-e9d6-80be-8325-e8ec694eee8b" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2015.png"><img style="width:240px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2015.png"/></a></figure></div><div id="147c01c0-e9d6-807b-b729-ceba626cc01c" style="width:16.666666666666668%" class="column"><p id="147c01c0-e9d6-8062-bb96-dd1c98a4d7fc" class="">i_start = 3</p><figure id="147c01c0-e9d6-80db-88d5-ce6c216380f0" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2016.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2016.png"/></a></figure><figure id="147c01c0-e9d6-802a-9415-cd9be194ecda" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2017.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2017.png"/></a></figure></div><div id="147c01c0-e9d6-80d7-8d76-e1874d9b250c" style="width:16.666666666666668%" class="column"><p id="147c01c0-e9d6-809a-888d-dcb1ca555a40" class="">i_start = 5</p><figure id="147c01c0-e9d6-809e-b5dc-de09e6ad4034" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2018.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2018.png"/></a></figure><figure id="147c01c0-e9d6-80fb-a485-c6ad167753f0" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2019.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2019.png"/></a></figure></div><div id="147c01c0-e9d6-80a7-95f6-d203bfe677ce" style="width:16.666666666666664%" class="column"><p id="147c01c0-e9d6-8038-9254-fb0110e6a59f" class="">i_start = 7</p><figure id="147c01c0-e9d6-808c-aebc-cbc348c5ec67" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2020.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2020.png"/></a></figure><figure id="147c01c0-e9d6-801b-ba80-eba228098935" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2021.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2021.png"/></a></figure></div><div id="147c01c0-e9d6-803a-a232-ed2c305455e2" style="width:16.66666666666667%" class="column"><p id="147c01c0-e9d6-80ff-99bf-d3c54305113a" class="">i_start = 10</p><figure id="147c01c0-e9d6-80a1-8c55-f38bb725d8bb" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2022.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2022.png"/></a></figure><figure id="147c01c0-e9d6-8046-a424-d5f1f78c017a" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2023.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2023.png"/></a></figure></div><div id="147c01c0-e9d6-803d-9dfc-f80d454b397b" style="width:16.666666666666668%" class="column"><p id="147c01c0-e9d6-8072-bbb2-edb8576c43c7" class="">i_start = 20</p><figure id="147c01c0-e9d6-80f3-92c7-ce04e3e1a34a" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2024.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2024.png"/></a></figure><figure id="147c01c0-e9d6-806f-abb5-e3ac1fc85fc8" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2025.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/image%2025.png"/></a></figure></div></div><h2 id="144c01c0-e9d6-8021-be01-e0b9a2035a4b" class="">1.7.2 <strong>Inpainting</strong></h2><p id="147c01c0-e9d6-8040-85d6-ddb7c549f827" class="">We can use the same procedure to implement inpainting (following the <a href="https://arxiv.org/abs/2201.09865">RePaint</a> paper). That is, given an image <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mtext>orig</mtext></msub></mrow><annotation encoding="application/x-tex">x_\text{orig}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">orig</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, and a binary mask <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span>, we can create a new image that has the same content where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span> is 0, but new content wherever <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span> is 1. </p><p id="147c01c0-e9d6-80e1-b257-fcfb905b3ffb" class="">
</p><p id="147c01c0-e9d6-8085-bad2-f9780a3a54ad" class="">Here is the results:</p><div id="144c01c0-e9d6-8089-a204-db1bf15f1c76" class="column-list"><div id="144c01c0-e9d6-8085-8d0a-db0e7783d3b7" style="width:33.33333333333333%" class="column"><p id="147c01c0-e9d6-80db-956e-c71838f40723" class=""><strong>Original Image:</strong></p><figure id="144c01c0-e9d6-80a1-b226-c490999d333f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile0_(1).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/campanile0_(1).png"/></a></figure></div><div id="144c01c0-e9d6-8007-94aa-f576b5fd986c" style="width:33.33333333333333%" class="column"><p id="147c01c0-e9d6-80df-ba4f-d3e41d3db5dd" class=""><strong>To Fill in:</strong></p><figure id="144c01c0-e9d6-804f-9bbd-fe3b03022a04" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Left_Alone_(3).png"><img style="width:240px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Left_Alone_(3).png"/></a></figure></div><div id="144c01c0-e9d6-808d-a7dd-df8a9d2b414f" style="width:33.33333333333333%" class="column"><p id="147c01c0-e9d6-8070-9226-df9cdf378e0b" class="">Inpainted</p><figure id="144c01c0-e9d6-8067-8fd5-fe33405ec7c6" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_inpaint_(4).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_inpaint_(4).png"/></a></figure></div></div><div id="144c01c0-e9d6-806c-a9cf-ef6492e0166a" class="column-list"><div id="144c01c0-e9d6-8018-8832-c5359385f2d6" style="width:33.333333333333336%" class="column"><figure id="144c01c0-e9d6-8023-ab88-faca9369264d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Image_(2).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Image_(2).png"/></a></figure></div><div id="144c01c0-e9d6-80f3-831a-fa220cfea383" style="width:33.33333333333333%" class="column"><figure id="144c01c0-e9d6-8056-8da0-ea538d13984a" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Left_Alone_(2).png"><img style="width:288px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Left_Alone_(2).png"/></a></figure></div><div id="144c01c0-e9d6-80d3-82e2-fa12924e30aa" style="width:33.333333333333336%" class="column"><figure id="144c01c0-e9d6-80ef-888c-d06bc9e59939" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_inpaint_(1).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_inpaint_(1).png"/></a></figure></div></div><div id="144c01c0-e9d6-801f-8b91-c59f4f0ef604" class="column-list"><div id="144c01c0-e9d6-80ae-bbc8-e137079d9c15" style="width:33.333333333333336%" class="column"><figure id="144c01c0-e9d6-8039-87ee-f80f34593cab" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asian.jpg"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asian.jpg"/></a></figure></div><div id="144c01c0-e9d6-80d4-805f-ea7a7909a99d" style="width:33.333333333333336%" class="column"><figure id="144c01c0-e9d6-800d-903d-fee8597662b7" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Left_Alone_(4).png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/Left_Alone_(4).png"/></a></figure></div><div id="144c01c0-e9d6-8066-bc5c-cc1d112cf348" style="width:33.33333333333333%" class="column"><figure id="144c01c0-e9d6-80ad-a7d9-cceea1e20c7b" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asian_inpaint_(1).png"><img style="width:240px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asian_inpaint_(1).png"/></a></figure></div></div><p id="147c01c0-e9d6-8013-bbc0-e074d7c3fd08" class=""><em>note: images may look different at each step because I upscaled it using stage 2 model. For ex, Danny DeVito is clean shaved in the original image, but appears to have a beared in the To Fill In.</em></p><h2 id="144c01c0-e9d6-805d-a532-d8a5d91d6497" class="">1.7.3 <strong>Text-Conditioned Image-to-image Translation</strong></h2><p id="147c01c0-e9d6-8048-b7f5-d808acff38f3" class="">Now, we will do the same thing as SDEdit, but guide the projection with a text prompt.</p><p id="144c01c0-e9d6-8056-b85e-c5a43de6a062" class="">Lets make the campanile into a rocket ship, using the prompt<strong> “a rocket ship”</strong></p><div id="144c01c0-e9d6-8057-98d9-d5c45ec05ffe" class="column-list"><div id="144c01c0-e9d6-80e6-aca8-f75b5e2fc3a3" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-802d-811d-d33a33c3037d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_1.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_1.png"/></a><figcaption>i_start = 1</figcaption></figure></div><div id="144c01c0-e9d6-80eb-a45e-c4c7fc144e4f" style="width:16.666666666666664%" class="column"><figure id="144c01c0-e9d6-80eb-9fde-ed4d6fc5138d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_3.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_3.png"/></a><figcaption>i_start = 3</figcaption></figure></div><div id="144c01c0-e9d6-80aa-b504-f50e5f1614a3" style="width:16.66666666666667%" class="column"><figure id="144c01c0-e9d6-805c-904b-db086a5fd4bb" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_5.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_5.png"/></a><figcaption>i_start = 5</figcaption></figure></div><div id="144c01c0-e9d6-8038-b609-dc88d8fe3a10" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-80c6-9fff-f8c1720093af" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_7.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_7.png"/></a><figcaption>i_start = 7</figcaption></figure></div><div id="144c01c0-e9d6-8015-b240-e12737932692" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-805b-be98-d71af27da0a5" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_10.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_10.png"/></a><figcaption>i_start = 10</figcaption></figure></div><div id="144c01c0-e9d6-8065-9cda-c2dcf08379fd" style="width:16.666666666666664%" class="column"><figure id="144c01c0-e9d6-80b2-ae4d-fa5701b717e8" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_20.png"><img style="width:192px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/camp_text_cond_rocket_i_start_20.png"/></a><figcaption>i_start = 20</figcaption></figure></div></div><p id="144c01c0-e9d6-80c9-a7be-caeb32037e67" class="">
</p><p id="144c01c0-e9d6-80d1-bdbb-fffae1032da0" class="">Danny DeVito translated with prompt “<strong>an oil painting of an old man”</strong></p><div id="144c01c0-e9d6-80f5-a004-c12cdfde999c" class="column-list"><div id="144c01c0-e9d6-80ba-97b8-f1495aeaba93" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-8002-8326-f89b8e96d160" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_1.png"><img style="width:96px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_1.png"/></a><figcaption>i_start = 1</figcaption></figure></div><div id="144c01c0-e9d6-80c5-be9c-c50c1e7d3198" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-8018-8ab9-d797edbcee7d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_3.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_3.png"/></a><figcaption>i_start = 3</figcaption></figure></div><div id="144c01c0-e9d6-80c7-81e0-dadaeb3d3f12" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-80ac-a139-e2e30bfc9c36" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_5.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_5.png"/></a><figcaption>i_start = 5</figcaption></figure></div><div id="144c01c0-e9d6-80b6-b7e1-d105c26a9211" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-8053-ba75-d276846256d1" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_7.png"><img style="width:96px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_7.png"/></a><figcaption>i_start = 7</figcaption></figure></div><div id="144c01c0-e9d6-802d-95c2-e44efa9a89b2" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-804b-96be-cf7929b12b6d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_10.png"><img style="width:96px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_10.png"/></a><figcaption>i_start = 10</figcaption></figure></div><div id="144c01c0-e9d6-80a7-bfb4-f39476c3e0c3" style="width:16.666666666666664%" class="column"><figure id="144c01c0-e9d6-803f-bb0b-ffc0eb88660a" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_20.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/danny_txt_cond_oil_i_start_20.png"/></a><figcaption>i_start = 20</figcaption></figure></div></div><p id="144c01c0-e9d6-8037-9ea1-cc716b62f009" class="">Lets give the Asian guy above a hat, using the prompt: <strong>“a man with a hat”</strong></p><div id="144c01c0-e9d6-8017-bb60-d5c674b8956d" class="column-list"><div id="144c01c0-e9d6-8075-a2d9-f211a52d1aab" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-80a2-88f6-e05b70cfd892" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_1.png"><img style="width:132px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_1.png"/></a><figcaption>i_start = 1</figcaption></figure></div><div id="144c01c0-e9d6-8060-bdd5-df7e2025b792" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-80df-ab4c-f9907418c752" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_3.png"><img style="width:132px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_3.png"/></a><figcaption>i_start = 3</figcaption></figure></div><div id="144c01c0-e9d6-8076-8189-ce45136ff42e" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-8030-a961-faa273853d88" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_5.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_5.png"/></a><figcaption>i_start = 5</figcaption></figure></div><div id="144c01c0-e9d6-802f-9f65-c88ce51c7906" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-803f-a558-cc6ffd8caa42" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_7.png"><img style="width:120px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_7.png"/></a><figcaption>i_start = 7</figcaption></figure></div><div id="144c01c0-e9d6-803c-8c9f-f28e3e2b9337" style="width:16.666666666666668%" class="column"><figure id="144c01c0-e9d6-80fe-83b1-c5e8acbd488b" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_10.png"><img style="width:108px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_10.png"/></a><figcaption>i_start = 10</figcaption></figure></div><div id="144c01c0-e9d6-80b9-9b6a-e0530153e42f" style="width:16.666666666666664%" class="column"><figure id="144c01c0-e9d6-8062-9ef7-c451bba7ba2c" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_20.png"><img style="width:144px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/asain_txt_cond_skull_i_start_20.png"/></a><figcaption>i_start = 20</figcaption></figure></div></div><p id="144c01c0-e9d6-804a-a825-c99148dd3257" class="">Pretty cool, we can see as we increase the i_start index (less blur) the more the translated image begins to look like the original image.</p><h2 id="144c01c0-e9d6-8070-8848-cffbb2377144" class=""><strong>1.8 Visual Anagrams</strong></h2><p id="147c01c0-e9d6-80f2-9405-c0f9e435f659" class="">In this part, we are finally ready to implement <a href="https://dangeng.github.io/visual_anagrams/">Visual Anagrams</a> and create optical illusions with diffusion models. In this part, we will create an image that looks like <em><code>&quot;an oil painting of people around a campfire&quot;</code></em>, but when flipped upside down will reveal <em><code>&quot;an oil painting of an old man&quot;</code></em>.</p><p id="147c01c0-e9d6-8054-8eb7-c561e126aaf2" class="">To do this, we will denoise an image <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> at step <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span>  normally with the prompt <em><code>&quot;an oil painting of an old man&quot;</code></em>, to obtain noise estimate <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. But at the same time, we will flip <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> upside down, and denoise with the prompt <em><code>&quot;an oil painting of people around a campfire&quot;</code></em>, to get noise estimate <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. We can flip <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> back, to make it right-side up, and average the two noise estimates. We can then perform a reverse/denoising diffusion step with the averaged noise estimate.</p><p id="147c01c0-e9d6-80c1-b36d-f938f561fb9d" class="">The full algorithm will be:</p><figure id="147c01c0-e9d6-80c8-bfd2-dae1d0cb1e08" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ϵ</mi><mn>1</mn></msub><mo>=</mo><mtext>UNet</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>ϵ</mi><mn>2</mn></msub><mo>=</mo><mtext>flip</mtext><mo stretchy="false">(</mo><mtext>UNet</mtext><mo stretchy="false">(</mo><mtext>flip</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>ϵ</mi><mo>=</mo><mfrac><mrow><msub><mi>ϵ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\epsilon_1 = \text{UNet}(x_t, t, p_1) \\
\epsilon_2 = \text{flip}(\text{UNet}(\text{flip}(x_t), t, p_2))\\
\epsilon = \frac{\epsilon_1 + \epsilon_2}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">UNet</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">flip</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">UNet</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">flip</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure><p id="147c01c0-e9d6-8054-a076-dcf64cc43cfa" class="">where <strong>UNet</strong> is the diffusion model UNet from before, <strong>flip(·)</strong> is a function that flips the image, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> are two different text prompt embeddings. And our final noise estimate is <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span>. </p><p id="147c01c0-e9d6-8062-9c70-dfd2318dab67" class="">
</p><p id="147c01c0-e9d6-80a1-bb17-f319a0e8e63c" class="">Here is images that the model generated:</p><div id="145c01c0-e9d6-805f-b0a3-eab607459019" class="column-list"><div id="145c01c0-e9d6-806c-9793-fb41793ecf62" style="width:50%" class="column"><figure id="145c01c0-e9d6-80d7-9ea9-f01b6a203d85" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_hybrid_(1).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_hybrid_(1).png"/></a><figcaption>prompt: an oil painting of an old man</figcaption></figure></div><div id="145c01c0-e9d6-807d-9ce0-d7502425e7a0" style="width:50%" class="column"><figure id="145c01c0-e9d6-8031-86dc-f274874ef409" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_hybrid_flipped.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_hybrid_flipped.png"/></a><figcaption>prompt: an oil painting of people around a campfire</figcaption></figure></div></div><div id="145c01c0-e9d6-80b1-8f01-ec55b05ec5ff" class="column-list"><div id="145c01c0-e9d6-80ae-bbfb-c7d266de862c" style="width:50%" class="column"><figure id="145c01c0-e9d6-8018-8c5e-fc15726e8209" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_anagram.png"><img style="width:240px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_anagram.png"/></a><figcaption>prompt: an oil painting of a cat</figcaption></figure></div><div id="145c01c0-e9d6-804b-bab1-cd5c1323d363" style="width:50%" class="column"><figure id="145c01c0-e9d6-80a7-ab13-d954b354a34e" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_flipped_anagram.png"><img style="width:240px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/oldman_fire_flipped_anagram.png"/></a><figcaption>prompt: an oil painting of a dog</figcaption></figure></div></div><div id="145c01c0-e9d6-8062-bdca-e497fe324dec" class="column-list"><div id="145c01c0-e9d6-806b-8cbc-cbf21c14f428" style="width:50%" class="column"><figure id="145c01c0-e9d6-80e5-b54e-dee43000373f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/women_grandma_anagram.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/women_grandma_anagram.png"/></a><figcaption>prompt: a shadow of a beautiful young women dancing</figcaption></figure></div><div id="145c01c0-e9d6-805e-9ca0-cb32aca71a7f" style="width:50%" class="column"><figure id="145c01c0-e9d6-805f-8e1c-c32a59a84a8d" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/women_grandma_flipped_anagram_(1).png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/women_grandma_flipped_anagram_(1).png"/></a><figcaption>prompt: an oil painting of an old women with a big nose, with a hoodie</figcaption></figure></div></div><h2 id="145c01c0-e9d6-8073-bf8a-dac1214b3d4e" class=""><strong>1.9 Hybrid Images</strong></h2><p id="147c01c0-e9d6-8043-8215-fc148772e839" class=""><a href="https://mokhalad.com/fun-with-frequencies/">https://mokhalad.com/fun-with-frequencies/</a></p><p id="147c01c0-e9d6-80bc-add6-f8df191bbb87" class="">In this part we&#x27;ll iimplement <a href="https://arxiv.org/abs/2404.11615">Factorized Diffusion</a> and create hybrid images just like in <a href="https://mokhalad.com/fun-with-frequencies/">project 2</a>.</p><p id="147c01c0-e9d6-8090-8011-fb6e24e30711" class="">In order to create hybrid images with a diffusion model we can use a similar technique as above. We will create a composite noise estimate ε, by estimating the noise with two different text prompts, and then combining low frequencies from one noise estimate with high frequencies of the other. The algorithm is:</p><figure id="147c01c0-e9d6-8007-8052-d7c5fa02a893" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ϵ</mi><mn>1</mn></msub><mo>=</mo><mtext>UNet</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>ϵ</mi><mn>2</mn></msub><mo>=</mo><mtext>UNet</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>ϵ</mi><mo>=</mo><msub><mi>f</mi><mtext>lowpass</mtext></msub><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>f</mi><mtext>highpass</mtext></msub><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon_1 = \text{UNet}(x_t, t, p_1) \\
\epsilon_2 = \text{UNet}(x_t, t, p_2) \\
\epsilon = f_{\text{lowpass}}(\epsilon_1) + f_{\text{highpass}}(\epsilon_2) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">UNet</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">UNet</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">lowpass</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">highpass</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></figure><p id="147c01c0-e9d6-804a-995b-ee131c05da06" class="">where UNet is the diffusion model UNet, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mtext>lowpass</mtext></msub></mrow><annotation encoding="application/x-tex">f_{\text{lowpass}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">lowpass</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is a low pass function, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mtext>highpass</mtext></msub></mrow><annotation encoding="application/x-tex">f_{\text{highpass}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">highpass</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is a high pass function, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> are two different text prompt embeddings. Our final noise estimate is  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span>. </p><p id="145c01c0-e9d6-8077-86f8-db41bcff3760" class="">Close Image Prompt (high frequencies): <strong>”a lithograph of waterfalls”<br/><br/></strong>Far Image Prompt (low frequencies): <strong>“a lithograph of waterfalls”</strong></p><figure id="145c01c0-e9d6-8079-9989-fa76a0f8d71c" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/skull_waterfall_hybrid.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/skull_waterfall_hybrid.png"/></a><figcaption>Skull Waterfall Hybrid</figcaption></figure><p id="145c01c0-e9d6-8005-bd26-d4af94b90ad5" class="">Close Image Prompt (high frequencies): <strong>”an oil painting of an old women with a big nose, with a hoodie”<br/><br/></strong>Far Image Prompt (low frequencies): <strong>“a lithograph of a skull”</strong></p><figure id="145c01c0-e9d6-8038-be62-f33552ec057c" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/grandma_skull_hybrid.png"><img style="width:255.99827575683594px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/grandma_skull_hybrid.png"/></a><figcaption>Grandma Skull Hybrid</figcaption></figure><p id="145c01c0-e9d6-80ab-8494-f738f4344a8b" class="">Close Image Prompt (high frequencies):  <strong>“an oil painting of a cat”<br/><br/></strong>Far Image Prompt (low frequencies): <strong>&quot;an oil painting of people around a campfire”</strong></p><figure id="145c01c0-e9d6-8057-991c-e15597b8e39f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cat_camp_hybrid.png"><img style="width:240px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/cat_camp_hybrid.png"/></a><figcaption>Cat Fire Camp Hybrid</figcaption></figure><p id="147c01c0-e9d6-807c-b2bf-ea7cbe7eb5db" class="">
</p><p id="147c01c0-e9d6-805b-b41a-e10a5a68accf" class="">In the next part, we’ll implement our own Diffusion Model!</p><hr id="147c01c0-e9d6-80b2-8144-e0af5a7d59dd"/><h1 id="147c01c0-e9d6-8012-9100-c310df5cb2aa" class=""><strong>Part B: Diffusion Models from Scratch!</strong></h1><h2 id="147c01c0-e9d6-806b-9f55-fa7e1342e67f" class="">Part 1: One Shot Denoiser</h2><h3 id="147c01c0-e9d6-80fe-bd5f-e954dec1c822" class=""><strong>1.2 Using the UNet to Train a Denoiser</strong></h3><figure id="147c01c0-e9d6-803e-962b-d75957ca051a" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/figure1.png"><img style="width:707.9774780273438px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/figure1.png"/></a><figcaption>Varying levels of noise on MNIST digits</figcaption></figure><h3 id="147c01c0-e9d6-8024-9cb5-fc9297f69f30" class=""><strong>1.2.1 Training</strong></h3><figure id="147c01c0-e9d6-80f6-9f78-d900a196d4c2" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/training_loss_curve.png"><img style="width:707.9861450195312px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/training_loss_curve.png"/></a></figure><p id="147c01c0-e9d6-80fe-b3a6-d19aec85fcff" class="">
</p><figure id="147c01c0-e9d6-80a8-8760-c35160457da7" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/figure56.png"><img style="width:707.9948120117188px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/figure56.png"/></a></figure><h3 id="147c01c0-e9d6-8098-bfac-e8a3f01040ce" class=""><strong>1.2.2 Out-of-Distribution Testing</strong></h3><p id="147c01c0-e9d6-8025-bcf1-ec6081b1e17c" class="">Our denoiser was trained on MNIST digits noised with σ=0.5. Let&#x27;s see how the denoiser performs on different σ&#x27;s that it wasn&#x27;t trained for.</p><figure id="147c01c0-e9d6-804e-802b-fb76e3d18a1f" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/figure7.png"><img style="width:707.9688110351562px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/figure7.png"/></a><figcaption>Results on Digits from the test set with varying noise levels.</figcaption></figure><h3 id="147c01c0-e9d6-80c7-abde-ec95cd6a3cf8" class="">2.2 Training the Time Conditioned UNet</h3><figure id="147c01c0-e9d6-80d5-bbbe-e5f19ff80e2b" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/ddpm_training_loss_curve2.png"><img style="width:707.9861450195312px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/ddpm_training_loss_curve2.png"/></a></figure><h3 id="147c01c0-e9d6-80ed-9d33-da4ff01d2f4a" class="">2.3 Sampling from the Time Conditioned UNet</h3><figure id="147c01c0-e9d6-80c8-b53b-e2ca45cc8866" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch5_res.png"><img style="width:707.93408203125px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch5_res.png"/></a></figure><figure id="147c01c0-e9d6-80b9-88cc-c6e3c7890d12" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch20_res.png"><img style="width:707.93408203125px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch20_res.png"/></a></figure><h3 id="147c01c0-e9d6-80eb-bcf6-d9c55cfe0dcd" class="">2.4 Training the Class-Conditioned UNet</h3><figure id="147c01c0-e9d6-8044-b2b3-e548acaccac4" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/c_loss.png"><img style="width:700.0000610351562px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/c_loss.png"/></a><figcaption>Class-conditioned UNET training loss curve</figcaption></figure><h3 id="147c01c0-e9d6-80e7-b7a2-fed97b23ab08" class=""><strong>2.5 Sampling from the Class-Conditioned UNet</strong></h3><figure id="147c01c0-e9d6-8057-baad-d147972bd78c" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch4.png"><img style="width:707.93408203125px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch4.png"/></a></figure><figure id="147c01c0-e9d6-80a8-a8c5-cf1438bd506e" class="image"><a href="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch20.png"><img style="width:707.93408203125px" src="Fun%20With%20Diffusion%20Models%20139c01c0e9d6800787adc2737e103c38/epoch20.png"/></a></figure></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>